(function(){var t,e={}.hasOwnProperty,o=function(t,o){function n(){this.constructor=t}for(var i in o)e.call(o,i)&&(t[i]=o[i]);return n.prototype=o.prototype,t.prototype=new n,t.__super__=o.prototype,t},n=function(t,e){return function(){return t.apply(e,arguments)}};RepoList.Models.Agency=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.initialize=function(){var t;return t=new RepoList.Collections.Repos,t.agency=this.get("account"),this.set("repos",t),this.view=new RepoList.Views.Agency({model:this})},e}(Backbone.Model),RepoList.Collections.Agencies=function(t){function e(){return this.initView=n(this.initView,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.model=RepoList.Models.Agency,e.prototype.url="{{ site.sm_api }}",e.prototype.agencies=$("#agencies"),e.prototype.parse=function(t){return t.accounts},e.prototype.initialize=function(){return this.on("sync",this.initView),this.on("add",this.getRepos)},e.prototype.getRepos=function(t){var e;return e=t.get("repos"),e.fetch({update:!0})},e.prototype.initView=function(t){var e,o,n,i;for(n=this.models,i=[],e=0,o=n.length;o>e;e++)t=n[e],this.agencies.append(t.view.el),i.push(t.view.render());return i},e.prototype.comparator="organization",e}(Backbone.Collection),RepoList.Models.Repo=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.initialize=function(){return this.view=new RepoList.Views.Repo({model:this}),this.on("change",this.view.render())},e}(Backbone.Model),RepoList.Collections.Repos=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.model=RepoList.Models.Repo,e.prototype.agency={},e.prototype.urlTemplate="{{ site.gh_api }}",e.prototype.url=function(){var t;return t=_.template(this.urlTemplate,{account:this.agency}),t+="&client_id={{ site.client_id }}",t+="&client_secret={{ site.client_secret }}",t},e.prototype.parse=function(t){return 200!==t.meta.status?($("#agencies").html(t.data.message),!1):t.data},e}(Backbone.Collection),RepoList.Views.Agency=function(t){function e(){return this.updateCount=n(this.updateCount,this),this.addRepo=n(this.addRepo,this),e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.className="agency",e.prototype.id=function(){return this.model.get("id")},e.prototype.initialize=function(){return this.model.get("repos").on("add",this.addRepo),this.model.get("repos").on("all",this.updateCount)},e.prototype.render=function(){return this.$el.html(RepoList.Templates.agency({agency:this.model.toJSON()}))},e.prototype.addRepo=function(t){return this.$el.find(".repos").append(t.view.el)},e.prototype.updateCount=function(){return this.$el.find(".count").html(this.model.get("repos").length)},e}(Backbone.View),RepoList.Views.Repo=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.className="repo",e.prototype.tagName="li",e.prototype.render=function(){return this.$el.html(RepoList.Templates.repo(this.model.toJSON()))},e}(Backbone.View),t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.routes={"":"index"},e.prototype.index=function(){return RepoList.agencies=new RepoList.Collections.Agencies,RepoList.agencies.fetch({update:!0})},e}(Backbone.Router),RepoList.router=new t,Backbone.history.start()}).call(this);